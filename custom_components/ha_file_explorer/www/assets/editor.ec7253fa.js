var m=Object.defineProperty,_=Object.defineProperties;var p=Object.getOwnPropertyDescriptors;var c=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var l=(e,t,o)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,i=(e,t)=>{for(var o in t||(t={}))v.call(t,o)&&l(e,o,t[o]);if(c)for(var o of c(t))k.call(t,o)&&l(e,o,t[o]);return e},u=(e,t)=>_(e,p(t));import{d as f,n as w,x as C,a as h,o as y,c as D,w as a,b as r,h as d,t as b,e as g}from"./index.fb48beca.js";import{A as B}from"./AppLayout.5122444e.js";const L=d("\u4FDD\u5B58"),V=d("\u53D6\u6D88"),$=g("div",{id:"editor"},null,-1),x=f({data(){return{name:""}},computed:i({},w(["absolutePath"])),created(){},mounted(){this.loadData(),document.addEventListener("keydown",this.saveKeydown,!1)},beforeRouteLeave(){document.removeEventListener("keydown",this.saveKeydown)},methods:{loadData(){const{name:e}=this.$route.params;if(!e)return this.$router.replace("/");this.name=e;const t=this.absolutePath(e),o=document.querySelector("#editor");o.innerHTML="",this.api.service.getHassFileContent(t).then(({code:n,data:s})=>{n>0||(o.textContent=s,window.editor=window.ace.edit("editor",{theme:"ace/theme/chrome",mode:C(this.name)}),document.body.scrollIntoView())})},cancelClick(){this.$router.back()},saveClick(){const e=this.absolutePath(this.name);let t=window.editor.getValue();this.api.service.setHassFileContent(e,t).then(o=>{this.$toast(o.msg)})},saveKeydown(e){e.ctrlKey&&e.key==="s"&&(this.$toast("\u6B63\u5728\u4FDD\u5B58\u4E2D..."),this.saveClick(),e.preventDefault())}}}),H=f(u(i({},x),{name:"editor",setup(e){return(t,o)=>{const n=h("va-chip"),s=h("va-button");return y(),D(B,{class:"views-editor"},{left:a(()=>[r(n,{flat:"",color:"#fff"},{default:a(()=>[d(b(t.name),1)]),_:1})]),right:a(()=>[r(s,{color:"#fff",flat:"",rounded:!1,onClick:t.saveClick},{default:a(()=>[L]),_:1},8,["onClick"]),r(s,{color:"#fff",flat:"",rounded:!1,onClick:t.cancelClick},{default:a(()=>[V]),_:1},8,["onClick"])]),default:a(()=>[$]),_:1})}}}));export{H as default};
