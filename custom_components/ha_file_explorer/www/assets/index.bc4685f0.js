var X=Object.defineProperty,Y=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var tt=Object.prototype.hasOwnProperty,et=Object.prototype.propertyIsEnumerable;var G=(n,o,i)=>o in n?X(n,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[o]=i,g=(n,o)=>{for(var i in o||(o={}))tt.call(o,i)&&G(n,i,o[i]);if(T)for(var i of T(o))et.call(o,i)&&G(n,i,o[i]);return n},w=(n,o)=>Y(n,Z(o));import{d as U,r as D,a,o as _,c as v,w as t,b as e,e as B,f as x,g as S,F as j,h as c,u as H,t as E,i as V,j as N,k as P,l as at,m as K,n as R,p as q,_ as O}from"./index.e6df408b.js";import{A as nt}from"./AppLayout.1d6bb0fe.js";const ot={class:"va-table"},lt=["href"],st={key:1},it=c(" OK "),ut=U({name:"VersionInfo",props:["ok"],setup(n){const o=n;H();const i="File Explorer",p=D(!0),C=new URLSearchParams(location.search),d=D([{name:"Version",value:C.get("v")||"dev"},{name:"Author",value:"shaonianzhentan"},{name:"Link",value:"https://github.com/shaonianzhentan/ha_file_explorer",type:"link"},{name:"UI",value:"https://vuestic.dev",type:"link"},{name:"Icon",value:"https://unpkg.com/@mdi/font@latest/preview.html",type:"link"},{name:"Bilibili",value:"https://space.bilibili.com/39523884",type:"link"},{name:"HA notes",value:"https://ha.jiluxinqing.com",type:"link"}]),u=async()=>{o.ok({})};return(r,f)=>{const b=a("va-button"),k=a("va-modal");return _(),v(k,{modelValue:p.value,"onUpdate:modelValue":f[0]||(f[0]=l=>p.value=l),title:i,"hide-default-actions":!0},{footer:t(()=>[e(b,{onClick:u},{default:t(()=>[it]),_:1})]),default:t(()=>[B("table",ot,[B("tbody",null,[(_(!0),x(j,null,S(d.value,l=>(_(),x("tr",{key:l.name},[B("td",null,E(l.name),1),B("td",null,[l.type==="link"?(_(),x("a",{key:0,href:l.value,target:"_blank"},E(l.value),9,lt)):(_(),x("span",st,E(l.value),1))])]))),128))])])]),_:1},8,["modelValue"])}}}),ct=c(" \u53D6\u6D88 "),_t=c(" \u786E\u5B9A "),dt={},J=U(w(g({},dt),{name:"CreateFile",props:["type","ok","cancel","app"],setup(n){const o=n,i=H(),p=o.type==="file",C=p?"\u6587\u4EF6":"\u6587\u4EF6\u5939",d=o.app(),u=D(""),r=D(!0),f=()=>{o.cancel()},b=async()=>{if(!u.value)return;const k=i.getters.absolutePath(u.value);let l=await N.service.createHassFile(p?"file":"folder",k);d.$toast(l.msg),!(l.code>0)&&(i.dispatch("reloadFileList"),o.ok({}))};return(k,l)=>{const s=a("va-input"),m=a("va-button"),h=a("va-modal");return _(),v(h,{modelValue:r.value,"onUpdate:modelValue":l[1]||(l[1]=F=>r.value=F),title:V(C),"hide-default-actions":!0},{footer:t(()=>[e(m,{outline:"",onClick:f,style:{"margin-right":"20px"}},{default:t(()=>[ct]),_:1}),e(m,{onClick:b,style:{"margin-left":"20px"}},{default:t(()=>[_t]),_:1})]),default:t(()=>[e(s,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=F=>u.value=F),modelModifiers:{trim:!0},placeholder:`${V(C)}\u540D\u79F0`},null,8,["modelValue","placeholder"])]),_:1},8,["modelValue","title"])}}})),rt=c(" \u6CE8\u610F\uFF1A\u76F8\u540C\u540D\u79F0\u6587\u4EF6\u4F1A\u88AB\u8986\u76D6 "),pt=c(" \u53D6\u6D88 "),mt=c(" \u786E\u5B9A "),vt={},Q=U(w(g({},vt),{name:"UploadFile",props:["type","ok","cancel","app"],setup(n){const o=n,i=H(),p=o.type==="file",C=p?"\u4E0A\u4F20\u6587\u4EF6":"\u4E0A\u4F20\u6587\u4EF6\u5939",d=o.app(),u=D([]),r=D(!0),f=l=>{const s=[];for(let m of l.target.files)s.push(m);u.value=s},b=()=>{o.cancel()},k=async()=>{u.value.length!==0&&Promise.all(u.value.map(l=>{const s=i.getters.absolutePath(p?l.name:l.webkitRelativePath);return N.service.uploadFile(s,l)})).then(l=>{d.$toast(`\u6210\u529F\u4E0A\u4F20${l.length}\u6587\u4EF6`),i.dispatch("reloadFileList"),o.ok({})})};return(l,s)=>{const m=a("va-progress-bar"),h=a("va-alert"),F=a("va-file-upload"),A=a("va-button"),L=a("va-modal");return _(),v(L,{modelValue:r.value,"onUpdate:modelValue":s[1]||(s[1]=z=>r.value=z),title:V(C),"hide-default-actions":!0},{footer:t(()=>[e(A,{disabled:V(i).state.loading,outline:"",onClick:b,style:{"margin-right":"20px"}},{default:t(()=>[pt]),_:1},8,["disabled"]),e(A,{disabled:V(i).state.loading,onClick:k,style:{"margin-left":"20px"}},{default:t(()=>[mt]),_:1},8,["disabled"])]),default:t(()=>[V(i).state.loading?(_(),v(m,{key:0,indeterminate:""})):P("",!0),e(h,{color:"danger",class:"mb-4"},{default:t(()=>[rt]),_:1}),p?(_(),v(F,{key:1,disabled:V(i).state.loading,modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=z=>u.value=z)},null,8,["disabled","modelValue"])):(_(),x("input",{key:2,type:"file",onChange:f,webkitdirectory:""},null,32))]),_:1},8,["modelValue","title"])}}})),ft=c(" \u53D6\u6D88 "),ht=c(" \u786E\u5B9A "),kt={},W=U(w(g({},kt),{name:"RenameFile",props:["type","name","ok","cancel","app"],setup(n){const o=n,i=H(),p=o.type==="file",C=p?"\u6587\u4EF6":"\u6587\u4EF6\u5939",d=at(()=>{if(p)return o.name;const s=i.getters.absolutePath(o.name).split("/");return s.splice(s.length-1,1),s[s.length-1]}),u=o.app(),r=D(""),f=D(!0),b=()=>{o.cancel()},k=async()=>{if(!r.value)return;let l=i.getters.absolutePath(o.name),s=i.getters.absolutePath(r.value);if(!p){const h=l.split("/");h.splice(h.length-1,1),l=h.join("/"),h[h.length-1]=r.value,s=h.join("/")}let m=await N.service.rename(l,s);u.$toast(m.msg),!(m.code>0)&&(i.dispatch("reloadFileList",p?"":s),o.ok({}))};return(l,s)=>{const m=a("va-alert"),h=a("va-input"),F=a("va-button"),A=a("va-modal");return _(),v(A,{modelValue:f.value,"onUpdate:modelValue":s[1]||(s[1]=L=>f.value=L),title:V(C),"hide-default-actions":!0},{footer:t(()=>[e(F,{outline:"",onClick:b,style:{"margin-right":"20px"}},{default:t(()=>[ft]),_:1}),e(F,{onClick:k,style:{"margin-left":"20px"}},{default:t(()=>[ht]),_:1})]),default:t(()=>[e(m,{outline:""},{default:t(()=>[c(" \u5F53\u524D\u540D\u79F0\uFF1A"+E(V(d)),1)]),_:1}),e(h,{modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=L=>r.value=L),modelModifiers:{trim:!0},placeholder:"\u65B0\u540D\u79F0"},null,8,["modelValue"])]),_:1},8,["modelValue","title"])}}})),bt={computed:g(g({},K(["fileList"])),R(["absolutePath"])),methods:w(g({},q(["reloadFileList"])),{deleteClick(n){parent.confirm(`\u786E\u5B9A\u5220\u9664\u6587\u4EF6\u3010${n}\u3011\uFF1F`)&&this.api.service.deleteHassFile(this.absolutePath(n)).then(o=>{this.reloadFileList(),this.$toast(o.msg)})},renameClick(n){this.$dialog(W,{type:"file",name:n})},editClick(n){this.$router.push({name:"editor",params:{name:n}})},addClick(){this.$dialog(J,{type:"file"})},uploadClick(){this.$dialog(Q,{type:"file"})}})},gt=c(" \u6587\u4EF6\u5217\u8868 "),Ct=c("\u4E0A\u4F20"),Ft=c("\u65B0\u589E"),yt=c("\u91CD\u547D\u540D"),$t=c("\u5220\u9664"),Et=c("\u7F16\u8F91");function Lt(n,o,i,p,C,d){const u=a("va-button"),r=a("va-button-group"),f=a("va-button-dropdown"),b=a("va-card-title"),k=a("mdi-icon"),l=a("va-avatar"),s=a("va-list-item-section"),m=a("va-list-item-label"),h=a("va-chip"),F=a("va-list-item"),A=a("va-list"),L=a("va-card-content"),z=a("va-card");return _(),v(z,null,{default:t(()=>[e(b,null,{default:t(()=>[gt,e(f,{outline:"",size:"small"},{default:t(()=>[e(r,{size:"small"},{default:t(()=>[e(u,{onClick:d.uploadClick},{default:t(()=>[Ct]),_:1},8,["onClick"]),e(u,{onClick:d.addClick},{default:t(()=>[Ft]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),e(L,null,{default:t(()=>[e(A,{style:{"padding-top":"0"}},{default:t(()=>[(_(!0),x(j,null,S(n.fileList,($,y)=>(_(),v(F,{key:y},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[e(l,{color:"var(--va-primary)"},{default:t(()=>[e(k,{name:$.icon},null,8,["name"])]),_:2},1024)]),_:2},1024),e(s,null,{default:t(()=>[e(m,null,{default:t(()=>[c(E($.name),1)]),_:2},1024),e(m,{caption:""},{default:t(()=>[c(E($.time)+" ",1),$.size?(_(),v(h,{key:0,flat:"",size:"small"},{default:t(()=>[c(E($.size),1)]),_:2},1024)):P("",!0)]),_:2},1024)]),_:2},1024),e(s,{icon:""},{default:t(()=>[e(f,{size:"small"},{default:t(()=>[e(r,{outline:"",size:"small"},{default:t(()=>[e(u,{onClick:I=>d.renameClick($.name)},{default:t(()=>[yt]),_:2},1032,["onClick"]),e(u,{onClick:I=>d.deleteClick($.name)},{default:t(()=>[$t]),_:2},1032,["onClick"]),e(u,{onClick:I=>d.editClick($.name)},{default:t(()=>[Et]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}var Vt=O(bt,[["render",Lt]]);const xt={data(){return{brands:new Array}},computed:g(g({},K(["folderList","path"])),R(["pathList"])),methods:w(g({},q(["getFileList"])),{showClick(n){this.getFileList(n.name)},addClick(){this.$dialog(J,{type:"dir"})},uploadClick(){this.$dialog(Q,{type:"dir"})},deleteClick(){const{pathList:n}=this,{name:o}=n[n.length-1];parent.confirm(`\u786E\u5B9A\u5220\u9664\u6587\u4EF6\u5939\u3010${o}\u3011\uFF1F`)&&this.api.service.deleteHassFile(this.path).then(i=>{this.getFileList(n.length-2),this.$toast(i.msg)})},renameClick(){this.$dialog(W,{type:"dir",name:""})},loadSrc(n){return this.brands.includes(n)?"https://brands.home-assistant.io/_/homeassistant/icon.png":n},loadIcon(n,o){this.brands.push(o),n.target.src="https://brands.home-assistant.io/_/homeassistant/icon.png"}})},At=c(" \u6587\u4EF6\u5939 "),wt=c("\u91CD\u547D\u540D"),Dt=c("\u4E0A\u4F20"),zt=c("\u5220\u9664"),Bt=c("\u65B0\u589E"),Pt=["src","onError"];function Ut(n,o,i,p,C,d){const u=a("va-button"),r=a("va-button-group"),f=a("va-button-dropdown"),b=a("va-card-title"),k=a("mdi-icon"),l=a("va-avatar"),s=a("va-list-item-section"),m=a("va-list-item-label"),h=a("va-chip"),F=a("va-icon"),A=a("va-list-item"),L=a("va-list"),z=a("va-card-content"),$=a("va-card");return _(),v($,null,{default:t(()=>[e(b,null,{default:t(()=>[At,e(f,{outline:"",size:"small"},{default:t(()=>[e(r,{size:"small"},{default:t(()=>[n.pathList.length>1?(_(),v(u,{key:0,onClick:d.renameClick},{default:t(()=>[wt]),_:1},8,["onClick"])):P("",!0),e(u,{onClick:d.uploadClick},{default:t(()=>[Dt]),_:1},8,["onClick"]),n.pathList.length>1?(_(),v(u,{key:1,onClick:d.deleteClick},{default:t(()=>[zt]),_:1},8,["onClick"])):P("",!0),e(u,{onClick:d.addClick},{default:t(()=>[Bt]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),e(z,null,{default:t(()=>[e(L,{style:{"padding-top":"0"}},{default:t(()=>[(_(!0),x(j,null,S(n.folderList,(y,I)=>(_(),v(A,{key:I},{default:t(()=>[e(s,{avatar:""},{default:t(()=>[y.iconType=="img"?(_(),x("img",{key:0,class:"brands",src:d.loadSrc(y.icon),onError:M=>d.loadIcon(M,y.icon)},null,40,Pt)):(_(),v(l,{key:1,color:"var(--va-primary)"},{default:t(()=>[e(k,{name:y.icon},null,8,["name"])]),_:2},1024))]),_:2},1024),e(s,null,{default:t(()=>[e(m,null,{default:t(()=>[c(E(y.name),1)]),_:2},1024),e(m,{caption:""},{default:t(()=>[c(E(y.time)+" ",1),y.size?(_(),v(h,{key:0,flat:"",size:"small"},{default:t(()=>[c(E(y.size),1)]),_:2},1024)):P("",!0)]),_:2},1024)]),_:2},1024),e(s,{icon:""},{default:t(()=>[e(F,{name:"remove_red_eye",color:"gray",onClick:M=>d.showClick(y)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}var It=O(xt,[["render",Ut],["__scopeId","data-v-ab94dd90"]]);const St=c("\u6587\u4EF6\u7BA1\u7406"),jt={class:"row"},Ht={class:"flex md6"},Nt={class:"flex md6"},Rt={computed:g({},R(["pathList"])),created(){this.changePathClick(0)},methods:w(g({},q(["getFileList"])),{changePathClick(n){this.getFileList(n)},versionClick(){this.$dialog(ut)}})},Gt=U(w(g({},Rt),{name:"index",setup(n){return(o,i)=>{const p=a("va-button"),C=a("va-breadcrumbs-item"),d=a("va-breadcrumbs"),u=a("va-card-title"),r=a("va-card"),f=a("va-backtop");return _(),v(nt,{class:"views-index"},{left:t(()=>[e(p,{color:"#fff",flat:"",rounded:!1,onClick:o.versionClick},{default:t(()=>[St]),_:1},8,["onClick"])]),right:t(()=>[]),default:t(()=>[e(r,null,{default:t(()=>[e(u,null,{default:t(()=>[e(d,null,{default:t(()=>[(_(!0),x(j,null,S(o.pathList,(b,k)=>(_(),v(C,{label:b.name,key:k,onClick:l=>o.changePathClick(k)},null,8,["label","onClick"]))),128))]),_:1})]),_:1})]),_:1}),B("div",jt,[B("div",Ht,[e(It)]),B("div",Nt,[e(Vt)])]),e(f,{target:"#va-app-bar-shadow","vertical-offset":"20px","horizontal-offset":"20px","visibility-height":1,speed:50})]),_:1})}}}));export{Gt as default};
