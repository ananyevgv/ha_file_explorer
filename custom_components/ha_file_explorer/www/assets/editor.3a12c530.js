var f=Object.defineProperty,m=Object.defineProperties;var p=Object.getOwnPropertyDescriptors;var d=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var l=(e,t,o)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,i=(e,t)=>{for(var o in t||(t={}))v.call(t,o)&&l(e,o,t[o]);if(d)for(var o of d(t))k.call(t,o)&&l(e,o,t[o]);return e},u=(e,t)=>m(e,p(t));import{j as _,a as w,q as C,u as y,x as D,r as h,o as b,c as g,w as a,g as r,h as c,t as B,k as $}from"./index.2de76b2f.js";import{_ as V}from"./AppLayout.98d264f7.js";const x=c("\u4FDD\u5B58"),F=c("\u53D6\u6D88"),K=$("div",{id:"editor"},null,-1),L=_({data(){return{name:""}},computed:i({},w(["absolutePath"])),created(){},mounted(){this.loadData(),document.addEventListener("keydown",this.saveKeydown,!1)},beforeRouteLeave(){document.removeEventListener("keydown",this.saveKeydown)},methods:{loadData(){const{name:e}=this.$route.params;if(!e)return this.$router.replace("/");this.name=e;const t=this.absolutePath(e),o=document.querySelector("#editor");o.innerHTML="",C(t).then(({code:n,data:s})=>{n>0||(o.textContent=s,window.editor=window.ace.edit("editor",{theme:"ace/theme/chrome",mode:y(e)}),document.body.scrollIntoView())})},cancelClick(){this.$router.back()},saveClick(){const e=this.absolutePath(this.name);let t=window.editor.getValue();D(e,t).then(o=>{this.$toast(o.msg)})},saveKeydown(e){e.ctrlKey&&e.key==="s"&&(this.$toast("\u6B63\u5728\u4FDD\u5B58\u4E2D..."),this.saveClick(),e.preventDefault())}}}),P=_(u(i({},L),{setup(e){return(t,o)=>{const n=h("va-chip"),s=h("va-button");return b(),g(V,{class:"views-editor"},{left:a(()=>[r(n,{flat:"",color:"#fff"},{default:a(()=>[c(B(t.name),1)]),_:1})]),right:a(()=>[r(s,{color:"#fff",flat:"",rounded:!1,onClick:t.saveClick},{default:a(()=>[x]),_:1},8,["onClick"]),r(s,{color:"#fff",flat:"",rounded:!1,onClick:t.cancelClick},{default:a(()=>[F]),_:1},8,["onClick"])]),default:a(()=>[K]),_:1})}}}));export{P as default};
