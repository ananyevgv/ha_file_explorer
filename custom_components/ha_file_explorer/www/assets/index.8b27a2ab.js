var J=Object.defineProperty,Q=Object.defineProperties;var W=Object.getOwnPropertyDescriptors;var q=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var M=(l,t,c)=>t in l?J(l,t,{enumerable:!0,configurable:!0,writable:!0,value:c}):l[t]=c,F=(l,t)=>{for(var c in t||(t={}))X.call(t,c)&&M(l,c,t[c]);if(q)for(var c of q(t))Y.call(t,c)&&M(l,c,t[c]);return l},z=(l,t)=>Q(l,W(t));import{d as E,r as U,a as n,o as p,c as y,w as e,b as a,e as x,f as P,g as N,F as S,h as d,u as j,t as o,i as _,j as H,k as I,l as Z,m as D,n as R,p as T,_ as ee}from"./index.ef1c59b6.js";import{l as s,_ as te}from"./AppLayout.c1884676.js";const ae={class:"va-table"},ne=["href"],le={key:1},oe=d(" OK "),se=E({name:"VersionInfo",props:["ok"],setup(l){const t=l;j();const c="File Explorer",r=U(!0),$=new URLSearchParams(location.search),L=U([{name:"Version",value:$.get("v")||"dev"},{name:"Author",value:"shaonianzhentan"},{name:"Link",value:"https://github.com/shaonianzhentan/ha_file_explorer",type:"link"},{name:"UI",value:"https://vuestic.dev",type:"link"},{name:"Icon",value:"https://unpkg.com/@mdi/font@latest/preview.html",type:"link"},{name:"Bilibili",value:"https://space.bilibili.com/39523884",type:"link"},{name:"HA notes",value:"https://ha.jiluxinqing.com",type:"link"}]),v=async()=>{t.ok({})};return(h,f)=>{const g=n("va-button"),C=n("va-modal");return p(),y(C,{modelValue:r.value,"onUpdate:modelValue":f[0]||(f[0]=i=>r.value=i),title:c,"hide-default-actions":!0},{footer:e(()=>[a(g,{onClick:v},{default:e(()=>[oe]),_:1})]),default:e(()=>[x("table",ae,[x("tbody",null,[(p(!0),P(S,null,N(L.value,i=>(p(),P("tr",{key:i.name},[x("td",null,o(i.name),1),x("td",null,[i.type==="link"?(p(),P("a",{key:0,href:i.value,target:"_blank"},o(i.value),9,ne)):(p(),P("span",le,o(i.value),1))])]))),128))])])]),_:1},8,["modelValue"])}}}),ie={},G=E(z(F({},ie),{name:"CreateFile",props:["type","ok","cancel","app"],setup(l){const t=l,c=j(),r=t.type==="file",$=r?s.file:s.folder,L=t.app(),v=U(""),h=U(!0),f=()=>{t.cancel()},g=async()=>{if(!v.value)return;const C=c.getters.absolutePath(v.value);let i=await H.service.createHassFile(r?"file":"folder",C);L.$toast(i.msg),!(i.code>0)&&(c.dispatch("reloadFileList"),t.ok({}))};return(C,i)=>{const u=n("va-input"),m=n("va-button"),k=n("va-modal");return p(),y(k,{modelValue:h.value,"onUpdate:modelValue":i[1]||(i[1]=w=>h.value=w),title:_($),"hide-default-actions":!0},{footer:e(()=>[a(m,{outline:"",onClick:f,style:{"margin-right":"20px"}},{default:e(()=>[d(o(_(s).cancel),1)]),_:1}),a(m,{onClick:g,style:{"margin-left":"20px"}},{default:e(()=>[d(o(_(s).confirm),1)]),_:1})]),default:e(()=>[a(u,{modelValue:v.value,"onUpdate:modelValue":i[0]||(i[0]=w=>v.value=w),modelModifiers:{trim:!0},placeholder:_(s).newName(_($))},null,8,["modelValue","placeholder"])]),_:1},8,["modelValue","title"])}}})),ce={},K=E(z(F({},ce),{name:"UploadFile",props:["type","ok","cancel","app"],setup(l){const t=l,c=j(),r=t.type==="file",$=`${s.upload} ${r?s.file:s.folder}`,L=t.app(),v=U([]),h=U(!0),f=U(!1),g=u=>{const m=[];for(let k of u.target.files)m.push(k);v.value=m},C=()=>{t.cancel()},i=async()=>{v.value.length!==0&&(f.value=!0,Promise.all(v.value.map(u=>{const m=c.getters.absolutePath(r?u.name:u.webkitRelativePath);return H.service.uploadFile(m,u)})).then(u=>{L.$toast(`\u6210\u529F\u4E0A\u4F20${u.length}\u6587\u4EF6`),c.dispatch("reloadFileList"),t.ok({}),f.value=!1}))};return(u,m)=>{const k=n("va-progress-bar"),w=n("va-alert"),V=n("va-file-upload"),b=n("va-button"),A=n("va-modal");return p(),y(A,{modelValue:h.value,"onUpdate:modelValue":m[1]||(m[1]=B=>h.value=B),title:$,"hide-default-actions":!0},{footer:e(()=>[a(b,{disabled:f.value,outline:"",onClick:C,style:{"margin-right":"20px"}},{default:e(()=>[d(o(_(s).cancel),1)]),_:1},8,["disabled"]),a(b,{disabled:f.value,onClick:i,style:{"margin-left":"20px"}},{default:e(()=>[d(o(_(s).confirm),1)]),_:1},8,["disabled"])]),default:e(()=>[f.value?(p(),y(k,{key:0,indeterminate:""})):I("",!0),a(w,{color:"danger",class:"mb-4"},{default:e(()=>[d(o(_(s).uploadTips),1)]),_:1}),r?(p(),y(V,{key:1,disabled:f.value,modelValue:v.value,"onUpdate:modelValue":m[0]||(m[0]=B=>v.value=B)},null,8,["disabled","modelValue"])):(p(),P("input",{key:2,type:"file",onChange:g,webkitdirectory:""},null,32))]),_:1},8,["modelValue"])}}})),ue={},O=E(z(F({},ue),{name:"RenameFile",props:["type","name","ok","cancel","app"],setup(l){const t=l,c=j(),r=t.type==="file",$=r?s.file:s.folder,L=Z(()=>{if(r)return t.name;const u=c.getters.absolutePath(t.name).split("/");return u.splice(u.length-1,1),u[u.length-1]}),v=t.app(),h=U(""),f=U(!0),g=()=>{t.cancel()},C=async()=>{if(!h.value)return;let i=c.getters.absolutePath(t.name),u=c.getters.absolutePath(h.value);if(!r){const k=i.split("/");k.splice(k.length-1,1),i=k.join("/"),k[k.length-1]=h.value,u=k.join("/")}let m=await H.service.rename(i,u);v.$toast(m.msg),!(m.code>0)&&(c.dispatch("reloadFileList",r?"":u),t.ok({}))};return(i,u)=>{const m=n("va-alert"),k=n("va-input"),w=n("va-button"),V=n("va-modal");return p(),y(V,{modelValue:f.value,"onUpdate:modelValue":u[1]||(u[1]=b=>f.value=b),title:_($),"hide-default-actions":!0},{footer:e(()=>[a(w,{outline:"",onClick:g,style:{"margin-right":"20px"}},{default:e(()=>[d(o(_(s).cancel),1)]),_:1}),a(w,{onClick:C,style:{"margin-left":"20px"}},{default:e(()=>[d(o(_(s).confirm),1)]),_:1})]),default:e(()=>[a(m,{outline:""},{default:e(()=>[d(o(_(s).currentName)+"\uFF1A"+o(_(L)),1)]),_:1}),a(k,{modelValue:h.value,"onUpdate:modelValue":u[0]||(u[0]=b=>h.value=b),modelModifiers:{trim:!0},placeholder:_(s).newName(_($))},null,8,["modelValue","placeholder"])]),_:1},8,["modelValue","title"])}}})),re={computed:F(F({},D(["fileList"])),R(["absolutePath"])),methods:z(F({},T(["reloadFileList"])),{deleteClick(l){parent.confirm(s.deleteConfirm(l))&&this.api.service.deleteHassFile(this.absolutePath(l)).then(t=>{this.reloadFileList(),this.$toast(t.msg)})},renameClick(l){this.$dialog(O,{type:"file",name:l})},editClick(l){this.$router.push({name:"editor",params:{name:l}})},addClick(){this.$dialog(G,{type:"file"})},uploadClick(){this.$dialog(K,{type:"file"})}})},de=E(z(F({},re),{name:"FileList",setup(l){return(t,c)=>{const r=n("va-button"),$=n("va-button-group"),L=n("va-button-dropdown"),v=n("va-card-title"),h=n("mdi-icon"),f=n("va-avatar"),g=n("va-list-item-section"),C=n("va-list-item-label"),i=n("va-chip"),u=n("va-list-item"),m=n("va-list"),k=n("va-card-content"),w=n("va-card");return p(),y(w,null,{default:e(()=>[a(v,null,{default:e(()=>[d(o(_(s).file)+" ",1),a(L,{outline:"",size:"small"},{default:e(()=>[a($,{size:"small"},{default:e(()=>[a(r,{onClick:t.uploadClick},{default:e(()=>[d(o(_(s).upload),1)]),_:1},8,["onClick"]),a(r,{onClick:t.addClick},{default:e(()=>[d(o(_(s).add),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),a(k,null,{default:e(()=>[a(m,{style:{"padding-top":"0"}},{default:e(()=>[(p(!0),P(S,null,N(t.fileList,(V,b)=>(p(),y(u,{key:b},{default:e(()=>[a(g,{avatar:""},{default:e(()=>[a(f,{color:"var(--va-primary)"},{default:e(()=>[a(h,{name:V.icon},null,8,["name"])]),_:2},1024)]),_:2},1024),a(g,null,{default:e(()=>[a(C,null,{default:e(()=>[d(o(V.name),1)]),_:2},1024),a(C,{caption:""},{default:e(()=>[d(o(V.time)+" ",1),V.size?(p(),y(i,{key:0,flat:"",size:"small"},{default:e(()=>[d(o(V.size),1)]),_:2},1024)):I("",!0)]),_:2},1024)]),_:2},1024),a(g,{icon:""},{default:e(()=>[a(L,{size:"small"},{default:e(()=>[a($,{outline:"",size:"small"},{default:e(()=>[a(r,{onClick:A=>t.renameClick(V.name)},{default:e(()=>[d(o(_(s).rename),1)]),_:2},1032,["onClick"]),a(r,{onClick:A=>t.deleteClick(V.name)},{default:e(()=>[d(o(_(s).delete),1)]),_:2},1032,["onClick"]),a(r,{onClick:A=>t.editClick(V.name)},{default:e(()=>[d(o(_(s).edit),1)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}}}));const _e=["src","onError"],pe={data(){return{brands:new Array}},computed:F(F({},D(["folderList","path"])),R(["pathList"])),methods:z(F({},T(["getFileList"])),{showClick(l){this.getFileList(l.name)},addClick(){this.$dialog(G,{type:"dir"})},uploadClick(){this.$dialog(K,{type:"dir"})},deleteClick(){const{pathList:l}=this,{name:t}=l[l.length-1];parent.confirm(`\u786E\u5B9A\u5220\u9664\u6587\u4EF6\u5939\u3010${t}\u3011\uFF1F`)&&this.api.service.deleteHassFile(this.path).then(c=>{this.getFileList(l.length-2),this.$toast(c.msg)})},renameClick(){this.$dialog(O,{type:"dir",name:""})},loadSrc(l){return this.brands.includes(l)?"https://brands.home-assistant.io/_/homeassistant/icon.png":l},loadIcon(l,t){this.brands.push(t),l.target.src="https://brands.home-assistant.io/_/homeassistant/icon.png"}})},me=E(z(F({},pe),{name:"FolderList",setup(l){return(t,c)=>{const r=n("va-button"),$=n("va-button-group"),L=n("va-button-dropdown"),v=n("va-card-title"),h=n("mdi-icon"),f=n("va-avatar"),g=n("va-list-item-section"),C=n("va-list-item-label"),i=n("va-chip"),u=n("va-icon"),m=n("va-list-item"),k=n("va-list"),w=n("va-card-content"),V=n("va-card");return p(),y(V,null,{default:e(()=>[a(v,null,{default:e(()=>[d(o(_(s).folder)+" ",1),a(L,{outline:"",size:"small"},{default:e(()=>[a($,{size:"small"},{default:e(()=>[t.pathList.length>1?(p(),y(r,{key:0,onClick:t.renameClick},{default:e(()=>[d(o(_(s).rename),1)]),_:1},8,["onClick"])):I("",!0),a(r,{onClick:t.uploadClick},{default:e(()=>[d(o(_(s).upload),1)]),_:1},8,["onClick"]),t.pathList.length>1?(p(),y(r,{key:1,onClick:t.deleteClick},{default:e(()=>[d(o(_(s).delete),1)]),_:1},8,["onClick"])):I("",!0),a(r,{onClick:t.addClick},{default:e(()=>[d(o(_(s).add),1)]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),a(w,null,{default:e(()=>[a(k,{style:{"padding-top":"0"}},{default:e(()=>[(p(!0),P(S,null,N(t.folderList,(b,A)=>(p(),y(m,{key:A},{default:e(()=>[a(g,{avatar:""},{default:e(()=>[b.iconType=="img"?(p(),P("img",{key:0,class:"brands",src:t.loadSrc(b.icon),onError:B=>t.loadIcon(B,b.icon)},null,40,_e)):(p(),y(f,{key:1,color:"var(--va-primary)"},{default:e(()=>[a(h,{name:b.icon},null,8,["name"])]),_:2},1024))]),_:2},1024),a(g,null,{default:e(()=>[a(C,null,{default:e(()=>[d(o(b.name),1)]),_:2},1024),a(C,{caption:""},{default:e(()=>[d(o(b.time)+" ",1),b.size?(p(),y(i,{key:0,flat:"",size:"small"},{default:e(()=>[d(o(b.size),1)]),_:2},1024)):I("",!0)]),_:2},1024)]),_:2},1024),a(g,{icon:""},{default:e(()=>[a(u,{name:"remove_red_eye",color:"gray",onClick:B=>t.showClick(b)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})}}}));var ve=ee(me,[["__scopeId","data-v-6c86ffe1"]]);const fe={class:"row"},he={class:"flex md6"},ke={class:"flex md6"},be={computed:F({},R(["pathList"])),created(){this.changePathClick(0)},methods:z(F({},T(["getFileList"])),{changePathClick(l){this.getFileList(l)},versionClick(){this.$dialog(se)}})},$e=E(z(F({},be),{name:"index",setup(l){return(t,c)=>{const r=n("va-button"),$=n("va-breadcrumbs-item"),L=n("va-breadcrumbs"),v=n("va-card-title"),h=n("va-card"),f=n("va-backtop");return p(),y(te,{class:"views-index"},{left:e(()=>[a(r,{color:"#fff",flat:"",rounded:!1,onClick:t.versionClick},{default:e(()=>[d(o(_(s).name),1)]),_:1},8,["onClick"])]),right:e(()=>[]),default:e(()=>[a(h,null,{default:e(()=>[a(v,null,{default:e(()=>[a(L,null,{default:e(()=>[(p(!0),P(S,null,N(t.pathList,(g,C)=>(p(),y($,{label:g.name,key:C,onClick:i=>t.changePathClick(C)},null,8,["label","onClick"]))),128))]),_:1})]),_:1})]),_:1}),x("div",fe,[x("div",he,[a(ve)]),x("div",ke,[a(de)])]),a(f,{target:"#va-app-bar-shadow","vertical-offset":"20px","horizontal-offset":"20px","visibility-height":1,speed:50})]),_:1})}}}));export{$e as default};
